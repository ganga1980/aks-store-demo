apiVersion: v1
kind: Service
metadata:
  name: admin-agent
  namespace: pets
  labels:
    app: admin-agent
    app.kubernetes.io/name: admin-agent
    app.kubernetes.io/component: service
    app.kubernetes.io/part-of: aks-store-demo
  annotations:
    # Azure Load Balancer annotations (optional)
    # Uncomment to use internal load balancer
    # service.beta.kubernetes.io/azure-load-balancer-internal: "true"
spec:
  type: LoadBalancer
  selector:
    app: admin-agent
  ports:
    - name: http
      protocol: TCP
      port: 80
      targetPort: 8000
  # Enable sticky sessions for Socket.IO/WebSocket connections
  # Required when running multiple replicas with Chainlit
  sessionAffinity: ClientIP
  sessionAffinityConfig:
    clientIP:
      timeoutSeconds: 3600 # 1 hour session stickiness
